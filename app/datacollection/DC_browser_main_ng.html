{% extends 'datacollection/DC_browser_base.html' %}

{% block body %}
    <div class="bs-docs-header" id="content">
        <div class="container"><h1><i class="fa fa-dashboard"></i> Dataset Browser</h1></div>
    </div>

    <div class="container">
    <div class="row">
        <div class="form-inline" role="form" id="filter-form">
            <div class="form-group col-sm-2" id="contain-word-div">
                <label id="contain-word-lab">Containing word(s): </label>
            </div>
            <div class="form-group col-sm-4">
                <input class="form-control" id="contain-word" ng-model="keyword">
                <span id="clear-all" class="glyphicon glyphicon-remove-circle"
                      ng-click="setFilter('keyword','')"></span>
            </div>
            <div class="col-sm-3">
                <button class="btn btn-primary btn-block" ng-click="setFilter('keyword', keyword)">
                    Search
                </button>
            </div>
            <div class="col-sm-3">
                <button class="btn btn-default dropdown-toggle btn-block" type="button" id="dropdownMenu1"
                        data-toggle="dropdown">
                    Options
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                    <li role="presentation"><a role="menuitem" tabindex="-1" href="#"
                                               ng-click="toggleIncompleteData()">
                        <span class="glyphicon glyphicon-ok" ng-show="incompleteHidden"></span>Hide
                        Incomplete Datasets</a></li>

                    <li role="presentation"><a role="menuitem" tabindex="-1" href="#"
                                               ng-click="toggleUnvalidatedData()">
                        <span class="glyphicon glyphicon-ok" ng-show="unvalidatedHidden"></span>Hide Unvalidated
                        Datasets</a></li>
                    <li role="presentation"><a role="menuitem" tabindex="-1" href="#"
                                               ng-click="datasetIDHidden=!datasetIDHidden">
                        <span class="glyphicon glyphicon-ok" ng-show="datasetIDHidden"></span>Hide Dataset IDs</a></li>
                </ul>
            </div>
        </div>
    </div>
    {% verbatim %}
    <div class="row">
        <div id="filter_section">
            <div class="col-sm-4">
                <div class="filter" id="specie-filter">
                    <label><h2>Species</h2></label>
                    <ul>
                        <li class="checked" ng-class="{checked: selectedFilterRow('species') == -1}"
                            ng-click="selectFilterRow('species', -1); setFilter('species', 'all')"> All
                        </li>
                        <li ng-repeat='specie in species' ng-bind="specie"
                            ng-class="{checked: selectedFilterRow('species') == $index}"
                            ng-click="selectFilterRow('species', $index);setFilter('species',specie)"></li>
                    </ul>

                </div>
            </div>

            <div class="col-sm-4" ng-class='{"col-sm-push-4": factorFirst}'>
                <div class="filter" id="cell-filter">
                    <label><h2>Biological Sources</h2></label>
                    <ul>
                        <li class="checked" ng-class="{checked: selectedFilterRow('cellinfos') == -1}"
                            ng-click="selectFilterRow('cellinfos', -1); setFilter('cellinfos', 'all')"> All
                        </li>
                        <li ng-repeat='cellinfo in cellinfos'
                            ng-class="{checked: selectedFilterRow('cellinfos') == $index}"
                            ng-click="selectFilterRow('cellinfos', $index); setFilter('cellinfos',cellinfo.join('_'))"
                            ng-bind="cellinfo[1]"></li>
                    </ul>
                </div>
            </div>
            <div class="col-sm-4" ng-class='{"col-sm-pull-4": factorFirst}'>
                <div class="filter" id="factor-filter">
                    <label>
                        <button id="toggle-factor-filter" class="btn btn-xs btn-default" ng-click="toggleFilterOrder()">
                            <i class="fa"
                               ng-class='{"fa-angle-double-left": !factorFirst, "fa-angle-double-right": factorFirst}'></i>
                        </button>
                        <h2> Factors</h2>
                    </label>
                    <ul>
                        <li class="checked" ng-class="{checked: selectedFilterRow('factors') == -1}"
                            ng-click="selectFilterRow('factors', -1); setFilter('factors', 'all')"> All
                        </li>
                        <li ng-repeat='factor in factors' ng-class="{checked: selectedFilterRow('factors') == $index}"
                            ng-click="selectFilterRow('factors', $index); setFilter('factors', factor)"
                            ng-bind="factor"></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <div class="panel panel-default" id="result-panel">
                <div class="panel-heading"><h2>Results</h2></div>
                <table class="table table-bordered table-hover" id="dataset-table">
                    <thead>
                    <tr>
                        <th>Species</th>
                        <th>Biological Source</th>
                        <th>Factor</th>
                        <th>Publication</th>
                        <th>Status</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="dataset in datasets" ng-class="{checked: selectedInspectorRow() == $index}"
                        ng-click="selectInspectorRow($index); setInspector(dataset.id)">
                        <td ng-bind="dataset.species__name"></td>
                        <td ng-bind="dataset | bioSource"></td>
                        <td ng-bind="dataset.factor__name"></td>
                        <td ng-bind="dataset.paper__pub_summary"></td>
                        <td ng-bind="dataset.status"></td>
                    </tr>
                    </tbody>

                </table>
                <div class="text-center form-inline" id="pagination">
                    <button id="prev-page-button" href="#" ng-class="{disabled: !pageCanPrev()}"
                            ng-click="setFilter('page', current_page - 1)"
                            class="btn btn-default top-align"><span
                            class="glyphicon glyphicon-backward"></span>
                        Prev
                    </button>
                    <div class="top-align">Page</div>
                    <div ng-class='{"has-success": pageInRange(), "has-warning": !pageInRange()}' class="form-group"
                         id="current-page-form">
                        <input type="number" ng-model="request_page" name="number"
                               step="1" data-bv-integer-message=" " size="3"
                               class="form-control">

                    </div>

                    <button id="goto-page-button" href="#"
                            ng-class='{"btn-success": pageInRange(), "btn-warning disabled": !pageInRange()}'
                            class="btn top-align" ng-click="setFilter('page', request_page)">
                        <span class="glyphicon glyphicon-play"></span></button>


                    <div class="top-align">of</div>
                    <div class="top-align" id="num-pages" ng-bind="num_pages"></div>

                    <button id="next-page-button" href="#" ng-class="{disabled: !pageCanNext()}"
                            ng-click="setFilter('page', current_page + 1)"
                            class="btn btn-default top-align">
                        Next <span class="glyphicon glyphicon-forward"></span></button>
                </div>
            </div>
        </div>
    </div>

    <div class="row" id="inspector_row" ng-hide="inspectorHidden">
    <div class="col-sm-12 inspector">
    <div class="panel panel-default" id="inspector-panel">
    <div class="panel-heading">
        <h2 id="inspector-header">Inspector <span ng-bind="inspector.id" ng-show="!datasetIDHidden"></span></h2>
    </div>

    <div class="row margin-zero">
        <div class="col-sm-9">
            <div class="row inspector_attrib_row">
                <div class="col-sm-3"><b>Title:</b></div>
                <div class="col-sm-9 inspector_attrib_value">
                    <b>Treatments</b>
                    <ul>
                        <li ng-repeat="treat in inspector.treats"><a
                                ng-href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc={{treat.unique_id}}"
                                ng-bind="treat.name"></a></li>
                    </ul>
                    <b ng-class="{hidden: inspector.conts.length==0}">Controls</b>
                    <ul ng-class="{hidden: inspector.conts.length==0}">
                        <li ng-repeat="cont in inspector.conts"><a
                                ng-href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc={{cont.unique_id}}"
                                ng-bind="cont.name"></a></li>
                    </ul>

                </div>

            </div>
            <div class="row inspector_attrib_row">
                <div class="col-sm-3"><b>Species:</b></div>
                <div class="col-sm-9 inspector_attrib_value" ng-bind="datasetHead.species__name"></div>
            </div>
            <div class="row inspector_attrib_row">
                <div class="col-sm-3"><b>Citation:</b></div>
                <div class="col-sm-9 inspector_attrib_value">
                    <div ng-bind="datasetHead.paper__reference"></div>
                    <span>PMID:</span>
                    <a ng-href="http://www.ncbi.nlm.nih.gov/pubmed/{{datasetHead.paper__pmid}}"
                       ng-bind="datasetHead.paper__pmid"></a>

                </div>
            </div>
            <div class="row inspector_attrib_row">
                <div class="col-sm-3"><b>Factor:</b></div>
                <div class="col-sm-9 inspector_attrib_value" ng-bind="datasetHead.factor__name"></div>
            </div>
            <div class="row inspector_attrib_row">
                <div class="col-sm-3"><b>Biological Source:</b></div>
                <div class="col-sm-9 inspector_attrib_value">
                    <p class="tight-line" ng-hide="!datasetHead.cell_line__name"><b>Cell
                        Line: </b><span ng-bind="datasetHead.cell_line__name"></span></p>

                    <p class="tight-line" ng-hide="!datasetHead.cell_type__name"><b>Cell
                        Type: </b><span ng-bind="datasetHead.cell_type__name"></span></p>

                    <p class="tight-line" ng-hide="!datasetHead.cell_pop__name"><b>Cell
                        Pop: </b><span ng-bind="datasetHead.cell_pop__name"></span></p>

                    <p class="tight-line" ng-hide="!datasetHead.strain__name"><b>Strain: </b><span
                            ng-bind="datasetHead.strain__name"></span></p>

                    <p class="tight-line" ng-hide="!datasetHead.tissue_type__name">
                        <b>Tissue: </b><span ng-bind="datasetHead.tissue_type__name"></span></p>

                    <p class="tight-line" ng-hide="!datasetHead.disease_state__name"><b>Disease: </b><span
                            ng-bind="datasetHead.disease_state__name"></span></p>
                </div>
            </div>

        </div>
        <div class="col-sm-3">

            <div class="row inspector-sub">
                <div class="col-sm-12" ng-hide="toolHidden" >
                    <strong>Quality Control</strong>
                </div>
                <div class="col-sm-12" id="qc-circles" ng-controller="qcController" ng-hide="toolHidden">

                    <div class="circle-col">
                        <div class="circle"
                             ng-class="{green: inspector.qc.judge.fastqc, red: !inspector.qc.judge.fastqc}"
                             data-toggle="tooltip" data-html="true" data-placement="auto"
                             title="<strong class='text-primary'>Sequence Quality:</strong><br> Raw sequence median quality score and raw read GC contents"
                             dc-tooltip></div>
                    </div>
                    <div class="circle-col">
                        <div class="circle"
                             ng-class="{green: inspector.qc.judge.map, red: !inspector.qc.judge.map}"
                             data-toggle="tooltip" data-html="true" data-placement="auto"
                             title="<strong class='text-primary'>Mapping Quality:</strong><br> Uniquely mapped ratio"
                             dc-tooltip></div>
                    </div>

                    <div class="circle-col">
                        <div class="circle"
                             ng-class="{green: inspector.qc.judge.pbc, red: !inspector.qc.judge.pbc}"
                             data-toggle="tooltip" data-html="true" data-placement="auto"
                             title="<strong class='text-primary'>Library Complexity:</strong><br> PCR bottleneck coefficient (PBC)"
                             dc-tooltip></div>
                    </div>

                    <div class="circle-col">
                        <div class="circle"
                             ng-class="{green: inspector.qc.judge.peaks, red: !inspector.qc.judge.peaks}"
                             data-toggle="tooltip" data-html="true" data-placement="auto"
                             title="<strong class='text-primary'>ChIP enrichment:</strong><br> Sufficient number of peaks(above 500) with good enrichment(10 fold change)"
                             dc-tooltip></div>
                    </div>

                    <div class="circle-col">
                        <div class="circle"
                             ng-class="{green: inspector.qc.judge.frip, red: !inspector.qc.judge.frip}"
                             data-toggle="tooltip" data-html="true" data-placement="auto"
                             title="<strong class='text-primary'>Signal to Noise Ratio:</strong><br> Fraction of reads in peaks (FRiP)"
                             dc-tooltip></div>
                    </div>
                    <div class="circle-col">
                        <div class="circle" data-toggle="tooltip" data-html="true" data-placement="auto"
                             title="<strong class='text-primary'>Evolutionary Conservation:</strong><br> Phastcons (mammals) conservation score around the peak summits"
                             dc-tooltip></div>
                    </div>

                    <div class="circle-col">
                        <div class="circle"
                             ng-class="{green: inspector.qc.judge.dhs, red: !inspector.qc.judge.dhs}"
                             data-toggle="tooltip" data-html="true" data-placement="auto"
                             title="<strong class='text-primary'>Regulatory Region:</strong><br>  'DNase-seq union hypersensitive sites' (DHS) overlapped ratio in top 5000 peaks "
                             dc-tooltip></div>
                    </div>
                    <div class="circle-col">
                        <div class="circle"
                             ng-class="{true: 'green', false: 'red', NA: 'grey'}[inspector.qc.judge.motif_judge]"
                             data-toggle="tooltip" data-html="true" data-placement="auto"
                             title="<strong class='text-primary'>Motif:</strong><br> Enrichment of corresponding motifs in peaks"
                             dc-tooltip></div>
                    </div>
                </div>
            </div>
            <div class="row inspector-sub">
                <div class="col-sm-12">
                    <strong>Visualize</strong>
                </div>
                <div class="col-sm-12">
                    <div class="btn-group">
                        <a target="_blank"
                           ng-href="http://epigenomegateway.wustl.edu/browser/?genome={{washuGenome}}&datahub=http://cistrome.org/dc/datahub/{{inspector.id}}&gftk=refGene,full"
                           ng-class="{disabled: toolHidden}" id="genomebrowser-bw" type="button"
                           class="btn btn-default button-list">WashU Browser</a>
                        <a target="_blank"
                           ng-href="http://cistrome.org/dc/hgtext/{{inspector.id}}/?db={{ucscGenome}}"
                           ng-class="{disabled: toolHidden}" id="genomebrowser-bw" type="button"
                           class="btn btn-default button-list">UCSC Browser</a>

                    </div>

                </div>

                <div class="col-sm-12">
                    <strong>Download</strong>
                </div>
                <div class="col-sm-12">
                    <div class="btn-group">
                        <button type="button"
                                class="btn btn-default dropdown-toggle button-list download-button"
                                data-toggle="dropdown" ng-class="{disabled: toolHidden}" >BED Peaks<span class="caret"></span></button>
                        <ul class="dropdown-menu" role="menu">
                            <li id="file-bed"><a target="_blank"
                                                 ng-href="http://cistrome.org/dc/file?type=bed&id={{inspector.id}}">Download
                                to My Computer</a></li>
                            <li>
                                <form method="POST" action="http://cistrome.org/ap/tool_runner" id="bed_sender">
                                    <input type="HIDDEN" value="cistrome_cr" name="tool_id">
                                    <input type="HIDDEN" value="bed" name="data_type">
                                    <input type="HIDDEN" value="http://cistrome.org/dc/file?type=bed&id={{inspector.id}}" name="URL">
                                    <input type="HIDDEN" value="{{inspector.id}}_peaks.bed" name="name">
                                </form>
                                <a href ng-click="send_bed()">Send to Analysis Pipeline</a></li>
                        </ul>
                    </div>


                    <div class="btn-group">
                        <button type="button"
                                class="btn btn-default dropdown-toggle button-list download-button"
                                data-toggle="dropdown" ng-class="{disabled: toolHidden}" >BIGWIG File<span class="caret"></span></button>
                        <ul class="dropdown-menu" role="menu">
                            <li>
                                <form method="POST" action="http://cistrome.org/ap/tool_runner" id="bw_sender">
                                    <input type="HIDDEN" value="cistrome_cr" name="tool_id">
                                    <input type="HIDDEN" value="bigwig" name="data_type">
                                    <input type="HIDDEN" value="http://cistrome.org/dc/file?type=bw&id={{inspector.id}}" name="URL">
                                    <input type="HIDDEN" value="{{inspector.id}}.bw" name="name">
                                </form>
                                <a href ng-click="send_bw()">Send to Analysis Pipeline</a></li>
                        </ul>
                    </div>

                    <div class="btn-group">
                        <a id="putative-target-file" type="button" class="btn btn-default button-list"
                           href="http://cistrome.org/dc/file?type=pt&id={{inspector.id}}" ng-class="{disabled: toolHidden}" >Putative Targets</a>


                    </div>

                    <!-- <a class="btn btn-default btn-block download-button" id="download-report" href="" download target="_blank"> -->
                    <!--     QC Report -->
                    <!-- </a> -->


                </div>

            </div>
        </div>

    </div>
    </div>
    </div>
    </div>

    <div class="row" ng-hide="inspectorHidden || toolHidden" id="tools_row">
        <div class="col-sm-12 tools">
            <div class="panel panel-default" id="tools-panel">
                <div class="panel-heading">
                    <h2 id="tools-header">Tools <span id="dataset-id" class="hidden"></span></h2>
                </div>

                <div class="row" id="toolTabSection">
                    <div class="col-sm-12">
                        <ul class="nav nav-tabs nav-justified" role="tablist" id="toolTab">
                            <li class="active"><a href="#qc-reports" dc-tab>QC reports</a></li>
                            <li ng-hide="inspector.qc.judge.motif_judge=='NA'"><a href="#qc-motif" ng-click="setMotif(inspector.id)" dc-tab>QC motifs</a></li>
                            <li><a href="#allTarget" id="target-trigger" ng-click="setTarget(inspector.id)" dc-tab>Get
                                top putative targets</a></li>
                            <li><a href="#peak" ng-click="targets=[]" dc-tab>Check a putative target</a></li>
                            <li><a href="#similar" ng-click="setSimilar(inspector.id)" dc-tab>Find similar datasets</a></li>
                        </ul>
                        <div id="toolTabContent" class="tab-content">
                            <div class="tab-pane fade in active" id="qc-reports">
                                <div class="tool-content" id="qc-reports-content" class="qc-reports-content-600px">

                                    <table class="table table-striped table-bordered" id="qc-tables">
                                        <thead>
                                        <tr>
                                            <th>QC</th>
                                            <th ng-repeat="sample in table.sample" ng-bind="sample"></th>
                                        </tr>
                                        <tbody>
                                        <tr>
                                            <td>Raw sequence median quality score</td>
                                            <td ng-repeat="seqScore in table.fastqc track by $index"
                                                ng-bind="seqScore"></td>
                                        </tr>
                                        <tr>
                                            <td>% Reads uniquely mapped</td>
                                            <td ng-repeat="uniqueMap in table.map track by $index"
                                                ng-bind="uniqueMap"></td>
                                        </tr>
                                        <tr>
                                            <td>PCR bottleneck coefficient (PBC)</td>
                                            <td ng-repeat="pbc in table.pbc track by $index" ng-bind="pbc"></td>
                                        </tr>
                                        <tr>
                                            <td>Number of merged Total/Fold 10/Fold 20 peaks</td>
                                            <td ng-bind="table.peaks.join(' / ')" colspan="{{columnCnt}}"></td>
                                        </tr>
                                        <tr ng-show="isNaN(table.peak_reps)">
                                            <td>Number of Total/Fold 10/Fold 20 peaks in each replicate</td>
                                            <td ng-repeat="peaksReps in table.peaks_reps track by $index"
                                                ng-bind="peaksReps"></td>
                                        </tr>

                                        <tr>
                                            <td>Fraction of reads in peaks (FRiP)</td>
                                            <td ng-repeat="frip in table.frip track by $index" ng-bind="frip"></td>
                                        </tr>
                                        <tr>
                                            <td>% Reads in promoter / exon / DHS regions</td>
                                            <td ng-repeat="emeta in table.e_meta track by $index"
                                                ng-bind="emeta"></td>
                                        </tr>
                                        <tr ng-show="isNaN(inspector.qc.overlap)">
                                            <td>Number of overlapping peaks</td>
                                            <td ng-bind="parseInt(inspector.qc.overlap)" colspan="{{columnCnt}}"></td>
                                        </tr>
                                        <tr ng-show="isNan(table.reps)">
                                            <td>Wiggle correlation coefficient</td>
                                            <td ng-bind="table.reps" colspan="{{columnCnt}}"></td>
                                        </tr>
                                        <tr>
                                            <td> % Peaks in promoter/exon/intron/intergenic</td>
                                            <td ng-bind="table.meta" colspan="{{columnCnt}}"></td>
                                        </tr>
                                        <tr>
                                            <td> % Top 5k peaks overlapping with union DHS</td>
                                            <td ng-bind="table.dhs"
                                                colspan="{{table.treat_number+table.control_number}}"></td>
                                        </tr>
                                        <tr>
                                          <td> % Top 5k peaks Phastcon Conservation Profiles
                                          </td>
                                          <td colspan="{{table.treat_number+table.control_number}}">
                                            <img ng-src="http://cistrome.org/dc/conserv?id={{ inspector.id }}"> </img>
                                          </td>
                                        </tr>
                                        </tbody>
                                        </thead>


                                    </table>
                                </div>
                            </div>
			    <div class="tab-pane fade" id="qc-motif">
			      <div class="row">
				<div class="col-sm-12">
				  <table class="table">
                                                <thead>
                                                <tr>
                                                    <th>Gene</th>
                                                    <th>Z Score</th>
                                                    <th>Hits</th>
                                                    <th>Logo</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr ng-repeat="motif in motifs">
                                                    <td  ng-bind="motif.factors"></td>
                                                    <td  ng-bind="motif.zscore | motifZscore"></td>
                                                    <td  ng-bind="motif.hits"></td>
                                                    <td  ng-bind="motif.id"></td>
                                                </tr>
                                                </tbody>


				  </table>
				</div>
			      </div>
			    </div>
                            <div class="tab-pane fade" id="peak">
                                <div class="tool-content">
                                    <div class="row">
                                        <div class="form-inline" role="form">
                                            <div class="form-group col-sm-9">
                                                <label for="gene_query">Check whether this gene is a putative
                                                    target: </label>
                                                <angucomplete id="mygene_genes"
                                                              placeholder="Search genes"
                                                              pause="400"
                                                              selectedObject="gene_query"
                                                              url=http://mygene.info/v2/query?fields=symbol%2Cname&species={{mygeneSpecies}}&q="
                                                              datafield="hits"
                                                              titlefield="symbol"
                                                              minlength="2"
                                                              descriptionfield="name"
                                                              inputclass="form-control"/>
                                            </div>
                                            <div class="col-sm-3">
                                                <button class="btn btn-primary btn-block" id="around-gene-search"
                                                        ng-click="setTarget(inspector.id, gene_query.title)">
                                                    Search
                                                </button>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <table class="table table-striped table-bordered table-condensed"
                                                   ng-hide="">
                                                <thead>
                                                <tr>
                                                    <th>Gene</th>
                                                    <th>Score</th>
                                                    <th>Coordinate</th>
                                                    <th>Visualize</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr ng-repeat="target in targets">
                                                    <td ng-bind="target.symbol"></td>
                                                    <td ng-bind="target.score"></td>
                                                    <td ng-bind="target.coordinate"></td>
                                                    <td><a target="_blank"
                                                           ng-href="http://epigenomegateway.wustl.edu/browser/?genome={{washuGenome}}&datahub=http://cistrome.org/dc/datahub/{{inspector.id}}&gftk=refGene,full&coordinate={{target.visual_coordinate}}"
                                                           class="btn btn-default btn-xs">WashU</a>
                                                        <a target="_blank"
                                                           ng-href="http://cistrome.org/dc/hgtext/{{inspector.id}}/?db={{ucscGenome}}&position={{target.visual_coordinate | escape}}"
                                                           class="btn btn-default btn-xs">UCSC</a></td>

                                                </tr>

                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="similar">
                                <div class="tool-content">
                                    <table class="table table-striped table-bordered table-condensed">
                                        <thead>
                                        <tr>
                                            <th>Dataset</th>
                                            <th>Score</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr ng-repeat="similar in similars">
                                            <td ng-bind="similar[0] | datasetMeta"></td>
                                            <td ng-bind="similar[1]"></td>
                                            </tr>
                                        </tbody>
                                    </table>

                                </div>
                            </div>
                            <div class="tab-pane fade" id="allTarget">
                                <div class="tool-content">
                                    <table class="table table-striped table-bordered table-condensed">
                                        <thead>
                                        <tr>
                                            <th>Gene</th>
                                            <th>Score</th>
                                            <th>Coordinate</th>
                                            <th>Visualize</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr ng-repeat="target in targets">
                                            <td ng-bind="target.symbol"></td>
                                            <td ng-bind="target.score"></td>
                                            <td ng-bind="target.coordinate"></td>
                                            <td><a target="_blank"
                                                   ng-href="http://epigenomegateway.wustl.edu/browser/?genome={{washuGenome}}&datahub=http://cistrome.org/dc/datahub/{{inspector.id}}&gftk=refGene,full&coordinate={{target.visual_coordinate}}"
                                                   class="btn btn-default btn-xs">WashU</a>
                                                <a target="_blank"
                                                   ng-href="http://cistrome.org/dc/hgtext/{{inspector.id}}/?db={{ucscGenome}}&position={{target.visual_coordinate | escape}}"
                                                   class="btn btn-default btn-xs">UCSC</a></td>

                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    {% endverbatim %}
{% endblock %}
